---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  cache = TRUE
)
```



# Single curve only

<!-- badges: start -->
<!-- badges: end -->

The prompt for Day 8 of [genuary](https://genuary.art) 2022 is "Single curve only".

Based on goodness-of-fit criteria, the gamma distribution was selected (see red line in Figure \ref{fig:TLD-Gamma-plot}) with the following shape and rate parameters (Table \ref{tab:gamma-param}) in the general form of: 
$$ 
f(x, \alpha, \beta) = \frac {x^{\alpha-1}e^{-\frac{x}{\beta}}}{ \beta^{\alpha}\Gamma(\alpha)} \quad \text{for }	0 \leq x \leq \infty
$$
\noindent where the estimated 'shape' is $\alpha$,the estimated 'rate' is $\beta$, and the $\Gamma(\alpha)$ is defined as:

$$
\Gamma(\alpha) =  \int_{0}^{\infty} x^{\alpha-1}e^{-x} \,dx
$$  

I will use the following packages in this exercise:
```{r load-packages, cache = FALSE, warning=FALSE, message=FALSE}
library(gridExtra)
library(MexBrewer) # Color palettes
library(tidyverse) # Data carpentry and visualization
```

Parameters from Toronto's callibration of distance decay function.
```{r}
df <- data.frame(x = 0:130) %>% 
  mutate(y = dgamma(x, shape = 2.01884797, rate = 0.09416746))
```

## Atentado

```{r}
col_palette <- mex.brewer("Atentado")

c_atentado <- list()
counter <- 0

col_1 <- c(5, 4, 3, 2, 1)

for(i in col_1){
  for(j in 6:10){
    counter <- counter + 1
    c_atentado[[counter]] <- ggplot(data = df) +
      #geom_line(aes(x = x, y = y)) +
      geom_ribbon(aes(x = x, 
                      ymin = y, 
                      ymax = 0.04),
                  fill = col_palette[i]) +
      geom_ribbon(aes(x = x, 
                      ymin = 0, 
                      ymax = y),
                  fill = col_palette[j]) +
      theme_void()
  }
}

grid.arrange(grobs=c_atentado, nrow = 5)
```

## Alacena

```{r}
col_palette <- mex.brewer("Alacena")

c_alacena <- list()
counter <- 0

col_1 <- c(5, 4, 3, 2, 1)

for(i in col_1){
  for(j in 6:10){
    counter <- counter + 1
    c_alacena[[counter]] <- ggplot(data = df) +
      #geom_line(aes(x = x, y = y)) +
      geom_ribbon(aes(x = x, 
                      ymin = y, 
                      ymax = 0.04),
                  fill = col_palette[i]) +
      geom_ribbon(aes(x = x, 
                      ymin = 0, 
                      ymax = y),
                  fill = col_palette[j]) +
      theme_void()
  }
}

grid.arrange(grobs=c_alacena, nrow = 5)
```

## Revolucion

```{r}
col_palette <- mex.brewer("Revolucion")

c_revolucion <- list()
counter <- 0

col_1 <- c(5, 4, 3, 2, 1)

for(i in col_1){
  for(j in 6:10){
    counter <- counter + 1
    c_revolucion[[counter]] <- ggplot(data = df) +
      #geom_line(aes(x = x, y = y)) +
      geom_ribbon(aes(x = x, 
                      ymin = y, 
                      ymax = 0.04),
                  fill = col_palette[i]) +
      geom_ribbon(aes(x = x, 
                      ymin = 0, 
                      ymax = y),
                  fill = col_palette[j]) +
      theme_void()
  }
}

grid.arrange(grobs=c_revolucion, nrow = 5)
```

## Ronda

```{r}
col_palette <- mex.brewer("Ronda")

c_ronda <- list()
counter <- 0

col_1 <- c(5, 4, 3, 2, 1)

for(i in col_1){
  for(j in 6:10){
    counter <- counter + 1
    c_ronda[[counter]] <- ggplot(data = df) +
      #geom_line(aes(x = x, y = y)) +
      geom_ribbon(aes(x = x, 
                      ymin = y, 
                      ymax = 0.04),
                  fill = col_palette[i]) +
      geom_ribbon(aes(x = x, 
                      ymin = 0, 
                      ymax = y),
                  fill = col_palette[j]) +
      theme_void()
  }
}

grid.arrange(grobs=c_ronda, nrow = 5)
```
